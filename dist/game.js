(()=>{"use strict";var t={484:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(845)),r=n(i(755)),s=n(i(534)),a=n(i(82)),l=function(){function t(t){var e=this;this.toGame=function(){var t,i;null===(t=e.onAd)||void 0===t||t.call(e),console.log("Start game"),e.app.scene.removeChildren(),null===(i=e.currentScreen)||void 0===i||i.destroy();var n=new s.default(e.app.scene);n.onWin=function(){e.toFinish(0)},n.onLose=function(){e.toFinish(1)},n.onDraw=function(){e.toFinish(2)},n.start(),e.currentScreen=n},this.toFinish=function(t){var i;null===(i=e.currentScreen)||void 0===i||i.destroy();var n="";switch(t){case 0:n="YOU WIN!";break;case 1:n="YOU LOSE!";break;case 2:n="DRAW"}var o=new r.default(n,e.app.scene);o.onPlay=e.toGame,o.onExit=e.toExit,o.start(),e.currentScreen=o},this.toExit=function(){var t;null===(t=e.currentScreen)||void 0===t||t.destroy(),window.location.assign("https://www.example.com")},this.onKeyEvent=function(t){var i;e.app.rendering&&(null===(i=e.currentScreen)||void 0===i||i.onKeyEvent(t))},this.app=new o.default(t),this.app.background="#ddd"}return t.prototype.prepare=function(){var t=new a.default(this.app.scene);t.onPlay=this.toGame,t.onExit=this.toExit,t.start(),this.currentScreen=t,this.subscribe()},t.prototype.play=function(){this.app.scene.visible=!0,this.app.rendering=!0},t.prototype.pause=function(){this.app.scene.visible=!1,this.app.rendering=!1},t.prototype.subscribe=function(){document.addEventListener("keydown",this.onKeyEvent)},t.prototype.unsubscribe=function(){document.removeEventListener("keydown",this.onKeyEvent)},t}();e.default=l},145:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=i(657),o=function(){function t(t){this.type=t,this.enemy=t===n.State.X?n.State.O:n.State.X}return t.prototype.getCoordinates=function(t){var e=this.findVictory(t);if(e)return console.log("AI: Victory: ",e),this.lineToCoord(t,e);var i=this.findDanger(t);if(i)return console.log("AI: Danger: ",i),this.lineToCoord(t,i);var n=this.findRandom(t);return n?(console.log("AI: Random: ",n),this.lineToCoord(t,n)):{x:-1,y:-1}},t.prototype.lineToCoord=function(t,e){var i=-1,o=-1,r=this.findEmpty(this.lineToArray(t,e));switch(e.line){case n.Line.Horizontal:i=r,o=e.coord;break;case n.Line.Vertical:i=e.coord,o=r;break;case n.Line.DiagonalLTRB:i=r,o=r;break;case n.Line.DiagonalLBRT:i=t[0].length-(r+1),o=r}return{x:i,y:o}},t.prototype.findVictory=function(t){for(var e=0;e<t.length;++e){var i={line:n.Line.Horizontal,coord:e},o=this.lineToArray(t,i);if(this.isVictory(o))return i;var r={line:n.Line.Vertical,coord:e},s=this.lineToArray(t,r);if(this.isVictory(s))return r}var a={line:n.Line.DiagonalLTRB,coord:0},l=this.lineToArray(t,a);if(this.isVictory(l))return a;var c={line:n.Line.DiagonalLBRT,coord:0},u=this.lineToArray(t,c);return this.isVictory(u)?c:void 0},t.prototype.findDanger=function(t){for(var e=0;e<t.length;++e){var i={line:n.Line.Horizontal,coord:e},o=this.lineToArray(t,i);if(this.isDanger(o))return i;var r={line:n.Line.Vertical,coord:e},s=this.lineToArray(t,r);if(this.isDanger(s))return r}var a={line:n.Line.DiagonalLTRB,coord:0},l=this.lineToArray(t,a);if(this.isDanger(l))return a;var c={line:n.Line.DiagonalLBRT,coord:0},u=this.lineToArray(t,c);return this.isDanger(u)?c:void 0},t.prototype.findRandom=function(t){for(var e=[],i=0;i<t.length;++i){var o={line:n.Line.Horizontal,coord:i},r=this.lineToArray(t,o);-1!==this.findEmpty(r)&&e.push(o);var s={line:n.Line.Vertical,coord:i},a=this.lineToArray(t,s);-1!==this.findEmpty(a)&&e.push(s)}var l={line:n.Line.DiagonalLTRB,coord:0},c=this.lineToArray(t,l);-1!==this.findEmpty(c)&&e.push(l);var u={line:n.Line.DiagonalLBRT,coord:0},h=this.lineToArray(t,u);return-1!==this.findEmpty(h)&&e.push(u),e[Math.floor(Math.random()*e.length)]},t.prototype.findEmpty=function(t){for(var e=[],i=0;i<t.length;++i)t[i]===n.State.Empty&&e.push(i);return 0===e.length?-1:e[Math.floor(Math.random()*e.length)]},t.prototype.lineToArray=function(t,e){if(e.line===n.Line.Horizontal)return t[e.coord];var i=[];if(e.line===n.Line.Vertical)for(var o=0;o<t.length;++o)i.push(t[o][e.coord]);if(e.line===n.Line.DiagonalLTRB)for(o=0;o<t.length;++o)i.push(t[o][o]);if(e.line===n.Line.DiagonalLBRT)for(o=0;o<t.length;++o)i.push(t[o][t[o].length-(o+1)]);return i},t.prototype.isVictory=function(t){for(var e=0,i=0,o=0;o<t.length;++o)t[o]===this.type&&e++,t[o]===n.State.Empty&&i++;return e>1&&i>0},t.prototype.isDanger=function(t){for(var e=0,i=0,o=0;o<t.length;++o)t[o]===this.enemy&&e++,t[o]===n.State.Empty&&i++;return e>1&&i>0},t}();e.default=o},490:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(846)),a=r(i(265)),l=r(i(4)),c=function(t){function e(e,i){var n=t.call(this,i)||this;return n.background=new l.default({width:300,height:50},"black",5,n),n.background.pivot.set(150,25),n.highlight=new l.default({width:280,height:40},"blue",0,n),n.highlight.pivot.set(140,20),n.highlight.visible=!1,n.text=new a.default(e,{family:"arial",size:30,color:"black"},n),n.text.pivot.set(100,20),n}return o(e,t),e.prototype.focus=function(){this.highlight.visible=!0},e.prototype.unfocus=function(){this.highlight.visible=!1},e.prototype.setWidth=function(t){this.background.size.width=t,this.background.pivot.x=t/2,this.highlight.size.width=t-20,this.highlight.pivot.x=t/2-10,this.text.pivot.x=t/2-50},e}(s.default);e.default=c},567:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(i,n,o,r){var s=t.call(this,r)||this;return s.animated=!0,s.time=0,s.stroke=3,s.color="blue",s.tick=function(t){var i;s.animated&&(s.time+=t,s.animated=s.time<=e.animationTime,s.animated||null===(i=s.onAnimationEnd)||void 0===i||i.call(s))},s.radius=i,o&&(s.stroke=o),n&&(s.color=n),s}return o(e,t),e.prototype.render=function(t){var i,n;if(this.prerender(t),t.beginPath(),this.animated){var o=null!==(n=null===(i=e.easing)||void 0===i?void 0:i.call(e,this.time/e.animationTime))&&void 0!==n?n:this.time/e.animationTime;t.arc(0,0,this.radius,e.startAngle,e.startAngle+2*Math.PI*o)}else t.arc(0,0,this.radius,0,2*Math.PI);t.lineWidth=this.stroke,t.strokeStyle=this.color,t.stroke(),t.closePath(),this.postrender(t)},e.animationTime=350,e.startAngle=-.5*Math.PI,e}(r(i(846)).default);e.default=s},854:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(i,n,o,r){var s=t.call(this,r)||this;return s.animated=!0,s.time=0,s.stroke=3,s.color="red",s.tick=function(t){var i;s.animated&&(s.time+=t,s.animated=s.time<=e.animationTime,s.animated||null===(i=s.onAnimationEnd)||void 0===i||i.call(s))},s.side=i,o&&(s.stroke=o),n&&(s.color=n),s}return o(e,t),e.prototype.render=function(t){var i,n;if(this.prerender(t),t.beginPath(),this.animated){var o=null!==(n=null===(i=e.easing)||void 0===i?void 0:i.call(e,this.time/e.animationTime))&&void 0!==n?n:this.time/e.animationTime;o<=.5?(t.moveTo(-.5*this.side,-.5*this.side),t.lineTo(this.side*(2*o-.5),this.side*(2*o-.5))):(t.moveTo(-.5*this.side,-.5*this.side),t.lineTo(.5*this.side,.5*this.side),t.moveTo(.5*this.side,-.5*this.side),t.lineTo(this.side*-(2*o-1-.5),this.side*(2*o-1-.5)))}else t.moveTo(-.5*this.side,-.5*this.side),t.lineTo(.5*this.side,.5*this.side),t.moveTo(.5*this.side,-.5*this.side),t.lineTo(-.5*this.side,.5*this.side);t.lineWidth=this.stroke,t.strokeStyle=this.color,t.stroke(),t.closePath(),this.postrender(t)},e.animationTime=350,e}(r(i(846)).default);e.default=s},116:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,i,n,o){void 0===e&&(e=200),void 0===i&&(i=3),void 0===n&&(n=3);var r=t.call(this,o)||this;return r.lineWidth=3,r.side=e,r.width=i,r.height=n,r}return o(e,t),e.prototype.render=function(t){this.prerender(t),t.beginPath();for(var e=1;e<this.width;++e)t.moveTo(this.side*e,0),t.lineTo(this.side*e,this.side*this.height);for(e=1;e<this.height;++e)t.moveTo(0,this.side*e),t.lineTo(this.side*this.width,this.side*e);t.stroke(),t.closePath(),this.postrender(t)},e}(r(i(846)).default);e.default=s},950:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(846)),a=r(i(265)),l=i(657),c=r(i(567)),u=r(i(854)),h=function(t){function e(e,i,n){var o=t.call(this,n)||this;return o.tick=function(t){o.children.forEach((function(e){var i;return null===(i=e.tick)||void 0===i?void 0:i.call(e,t)}))},new a.default(e,{color:"#000",size:40,family:"arial"},o).position.set(70,10),(i===l.State.X?new u.default(200,"red",4,o):new c.default(100,"blue",4,o)).position.set(100,160),o}return o(e,t),e}(s.default);e.default=h},4:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,i,n,o){var r=t.call(this,o)||this;return r.color="red",r.stroke=0,r.size=e,i&&(r.color=i),n&&(r.stroke=n),r}return o(e,t),e.prototype.render=function(t){this.visible&&(this.prerender(t),t.beginPath(),t.rect(0,0,this.size.width,this.size.height),t.lineWidth=this.stroke,t.strokeStyle=this.color,t.fillStyle=this.color,this.stroke?t.stroke():t.fill(),t.closePath(),this.postrender(t))},e}(r(i(846)).default);e.default=s},156:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o,r,s,a=n(i(484));window.addEventListener("load",(function(){var t=document.getElementById("canvas");if(t){console.log("Running game");var e=document.getElementById("gameContainer"),i=new a.default(t);i.prepare();var n=function(t){console.error("Ad error: "+t.getError().toString()),null==s||s.destroy(),i.play()},l=function(){i.pause()},c=function(){i.play()},u=function(t){t.type===google.ima.AdEvent.Type.ALL_ADS_COMPLETED&&i.play()},h=document.getElementById("adContainer");o=new google.ima.AdDisplayContainer(h,e),(r=new google.ima.AdsLoader(o)).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(t){(s=t.getAdsManager()).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,n),s.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,l),s.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,c),s.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,u);try{s.init(640,360,google.ima.ViewMode.NORMAL),s.start()}catch(t){console.error("AD error: ",t),i.play()}}),!1),r.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,n,!1),i.onAd=function(){var t;i.pause(),(t=new google.ima.AdsRequest).adTagUrl="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dlinear&correlator=",t.linearAdSlotWidth=640,t.linearAdSlotHeight=360,t.nonLinearAdSlotWidth=640,t.nonLinearAdSlotHeight=120,r.requestAds(t),o.initialize()},i.play()}else console.error("Can't find canvas with id 'canvas'")}))},845:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(846)),r=function(){function t(t){var e=this;this._time=-1,this.time=0,this.background="white",this._rendering=!1,this.render=function(){var t=e.context;if(t){t.fillStyle=e.background,t.fillRect(0,0,e.width,e.height),e.scene.render(t),e._time<0&&(e._time=window.performance.now());var i=e._time;e._time=window.performance.now();var n=e._time-i;e.time+=n,e.tick(n),e._rendering?requestAnimationFrame(e.render):e._time=-1}else console.warn("Can't get context to draw on")},this.canvas=t,this.context=this.canvas.getContext("2d",{alpha:!1})||void 0,this.width=this.canvas.width,this.height=this.canvas.height,this.scene=new o.default}return t.prototype.tick=function(t){this.scene.tick?this.scene.tick(t):this.scene.children.forEach((function(e){var i;return null===(i=e.tick)||void 0===i?void 0:i.call(e,t)}))},Object.defineProperty(t.prototype,"rendering",{get:function(){return this._rendering},set:function(t){this._rendering=t,this._rendering&&this.render()},enumerable:!1,configurable:!0}),t}();e.default=r},846:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(801)),r=function(){function t(t){this.rotation=0,this.alpha=1,this.visible=!0,this.interactive=!1,this.children=[],this._alpha=1,this.position=new o.default,this.pivot=new o.default,this.scale=new o.default(1,1),t&&t.addChild(this)}return t.prototype.destroy=function(){},t.prototype.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t)},t.prototype.addChildAt=function(t,e){t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t)},t.prototype.removeChild=function(t){var e=this.children.indexOf(t);e<0||(t.parent=void 0,this.children.splice(e,1))},t.prototype.removeChildren=function(){this.children.forEach((function(t){return t.parent=void 0})),this.children=[]},t.prototype.prerender=function(t){t.save(),t.translate(this.position.x,this.position.y),t.rotate(this.rotation),t.scale(this.scale.x,this.scale.y),t.translate(-this.pivot.x,-this.pivot.y),this._alpha=t.globalAlpha,t.globalAlpha=Math.min(Math.max(0,this._alpha*this.alpha),1)},t.prototype.render=function(t){this.visible&&(this.prerender(t),this.postrender(t))},t.prototype.postrender=function(t){this.children.forEach((function(e){return e.render(t)})),t.restore(),t.globalAlpha=this._alpha},t}();e.default=r},265:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,i,n){var o=t.call(this,n)||this;return o.text=e,o.style=i,o}return o(e,t),e.prototype.render=function(t){this.visible&&(this.prerender(t),t.font="".concat(this.style.size,"px ").concat(this.style.family),t.fillStyle=this.style.color,t.fillText(this.text,0,this.style.size),this.postrender(t))},e}(r(i(846)).default);e.default=s},801:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e},t}();e.default=i},755:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(490)),a=r(i(4)),l=r(i(846)),c=r(i(265)),u=function(t){function e(e,i){var n=t.call(this,i)||this;n.selected=0,n.onKeyEvent=function(t){switch(t.keyCode){case 37:n.select(n.selected-1);break;case 39:n.select(n.selected+1);break;case 13:n.enter()}};var o=new l.default(n);o.position.set(640,360);var r=new a.default({width:720,height:360},"#aaa",0,o);r.pivot.set(360,180),r.alpha=.6,new a.default({width:720,height:360},"black",5,o).pivot.set(360,180),new c.default(e,{family:"arial",size:50,color:"black"},o).position.set(-150,-150);var u=new s.default("Play",o);u.setWidth(170),u.position.set(-120,50);var h=new s.default("Exit",o);return h.setWidth(170),h.position.set(120,50),n.buttons=[u,h],n}return o(e,t),e.prototype.select=function(t){this.buttons[this.selected].unfocus(),this.selected=Math.max(0,Math.min(t,this.buttons.length-1)),this.buttons[this.selected].focus()},e.prototype.enter=function(){var t,e;switch(this.selected){case 0:null===(t=this.onPlay)||void 0===t||t.call(this);break;case 1:null===(e=this.onExit)||void 0===e||e.call(this)}},e.prototype.start=function(){this.select(0)},e.prototype.destroy=function(){this.onExit=void 0,this.onPlay=void 0},e}(l.default);e.default=u},534:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,o)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return s(e,t),e},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var c=l(i(145)),u=l(i(567)),h=l(i(854)),d=l(i(116)),f=l(i(950)),p=l(i(4)),y=l(i(846)),v=l(i(801)),_=a(i(657)),m=function(t){function e(e){var i=t.call(this,e)||this;i.field=[[0,0,0],[0,0,0],[0,0,0]],i.turn=_.State.X,i.locked=!1,i.onElementAnimEnd=function(){var t,e=_.check(i.field);console.log(e),e.win?i.drawWin(e):e.draw?null===(t=i.onDraw)||void 0===t||t.call(i):i.turn===i.playerType?i.lock(!1):i.playAI()},i.tick=function(t){i.fieldElement.children.forEach((function(e){var i;return null===(i=e.tick)||void 0===i?void 0:i.call(e,t)})),i.children.forEach((function(e){var i;return null===(i=e.tick)||void 0===i?void 0:i.call(e,t)}))},i.onKeyEvent=function(t){if(!i.locked)switch(t.keyCode){case 37:i.moveCursor(-1,0);break;case 38:i.moveCursor(0,-1);break;case 39:i.moveCursor(1,0);break;case 40:i.moveCursor(0,1);break;case 13:i.onEnter()}},i.cursor=new v.default(1,1),i.fieldElement=new d.default(200,3,3,i),i.fieldElement.position.set(340,60),i.cursorElement=new p.default({width:190,height:190},"#666",3,i.fieldElement),i.cursorElement.pivot.set(95,95);var n=100+200*i.cursor.x,o=100+200*i.cursor.y;i.cursorElement.position.set(n,o);var r=Math.random();return i.playerType=r<.5?_.State.X:_.State.O,i.aiType=r<.5?_.State.O:_.State.X,i.ai=new c.default(i.aiType),new f.default("YOU",i.playerType,i).position.set(70,230),new f.default("AI",i.aiType,i).position.set(1010,230),i}return o(e,t),e.prototype.moveCursor=function(t,e){this.cursor.x=Math.max(0,Math.min(this.cursor.x+t,this.field[0].length-1)),this.cursor.y=Math.max(0,Math.min(this.cursor.y+e,this.field.length-1));var i=100+200*this.cursor.x,n=100+200*this.cursor.y;this.cursorElement.position.set(i,n)},e.prototype.placeElement=function(t,e,i){if(this.field[e][t]!==_.State.Empty)return!1;this.field[e][t]=i;var n=i===_.State.X?new h.default(180,"red",3,this.fieldElement):new u.default(90,"blue",3,this.fieldElement);return n.position.set(100+200*t,100+200*e),n.onAnimationEnd=this.onElementAnimEnd,this.lock(!0),this.turn=this.turn===_.State.X?_.State.O:_.State.X,!0},e.prototype.playAI=function(){if(this.aiType===this.turn){var t=this.ai.getCoordinates(this.field);this.placeElement(t.x,t.y,this.aiType)}else console.warn("AI can't play, players turn")},e.prototype.lock=function(t){this.locked=t,this.cursorElement.visible=!this.locked},e.prototype.drawWin=function(t){var e=this,i=new h.default(180,"green",9,this.fieldElement);switch(t.line){case _.Line.Horizontal:i.scale.x=3.3,i.scale.y=.5,i.position.x=.5*this.field[0].length*200,i.position.y=100+200*t.coord;break;case _.Line.Vertical:i.scale.x=.5,i.scale.y=3.3,i.position.x=100+200*t.coord,i.position.y=.5*this.field.length*200;break;case _.Line.DiagonalLTRB:i.scale.x=4,i.scale.y=.5,i.position.x=.5*this.field[0].length*200,i.position.y=.5*this.field.length*200,i.rotation=.25*Math.PI;break;case _.Line.DiagonalLBRT:i.scale.x=4,i.scale.y=.5,i.position.x=.5*this.field[0].length*200,i.position.y=.5*this.field.length*200,i.rotation=-.25*Math.PI}i.onAnimationEnd=function(){var i,n;t.value===e.playerType&&(null===(i=e.onWin)||void 0===i||i.call(e)),t.value===e.aiType&&(null===(n=e.onLose)||void 0===n||n.call(e))}},e.prototype.onEnter=function(){this.placeElement(this.cursor.x,this.cursor.y,this.playerType)},e.prototype.start=function(){this.aiType===this.turn&&this.playAI()},e.prototype.destroy=function(){this.onDraw=void 0,this.onWin=void 0,this.onLose=void 0},e}(y.default);e.default=m},82:function(t,e,i){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(i(490)),a=r(i(4)),l=r(i(846)),c=r(i(265)),u=function(t){function e(e){var i=t.call(this,e)||this;i.selected=0,i.onKeyEvent=function(t){switch(t.keyCode){case 37:i.select(i.selected-1);break;case 39:i.select(i.selected+1);break;case 13:i.enter()}};var n=new l.default(i);n.position.set(640,360),new a.default({width:720,height:360},"black",5,n).pivot.set(360,180),new c.default("TIC-TAC-TOE",{family:"arial",size:50,color:"black"},n).position.set(-150,-150);var o=new s.default("Play",n);o.setWidth(170),o.position.set(-120,50);var r=new s.default("Exit",n);return r.setWidth(170),r.position.set(120,50),i.buttons=[o,r],i}return o(e,t),e.prototype.select=function(t){this.buttons[this.selected].unfocus(),this.selected=Math.max(0,Math.min(t,this.buttons.length-1)),this.buttons[this.selected].focus()},e.prototype.enter=function(){var t,e;switch(this.selected){case 0:null===(t=this.onPlay)||void 0===t||t.call(this);break;case 1:null===(e=this.onExit)||void 0===e||e.call(this)}},e.prototype.start=function(){this.select(0)},e.prototype.destroy=function(){this.onExit=void 0,this.onPlay=void 0},e}(l.default);e.default=u},657:(t,e)=>{var i,n;Object.defineProperty(e,"__esModule",{value:!0}),e.Line=e.State=void 0,e.check=function(t){for(var e=!1,o=n.Horizontal,r=0,s=!0,a=i.Empty,l=0;l<t.length;++l)if((u=t[l][0])!==i.Empty){e=!0;for(var c=1;c<t[l].length&&(e=u===t[l][c],s=s&&t[l][c]!==i.Empty,e);++c);if(e){o=n.Horizontal,r=l,s=!1,a=u;break}}else s=!1;if(!e)for(l=0;l<t[0].length;++l)if((u=t[0][l])!==i.Empty){for(e=!0,c=1;c<t.length&&(e=u===t[c][l],s=s&&t[c][l]!==i.Empty,e);++c);if(e){o=n.Vertical,r=l,s=!1,a=u;break}}else s=!1;if(!e){if((u=t[0][0])!==i.Empty)for(e=!0,l=1;l<t.length&&(e=u===t[l][l],s=s&&t[l][l]!==i.Empty,e);++l);else s=!1;e&&(o=n.DiagonalLTRB,s=!1,a=u)}if(!e){var u;if((u=t[0][t[0].length-1])!==i.Empty)for(e=!0,l=1;l<t.length&&(e=u===t[l][t[l].length-(l+1)],s=s&&t[l][t[l].length-(l+1)]!==i.Empty,e);l++);else s=!1;e&&(o=n.DiagonalLBRT,s=!1,a=u)}return{win:e,line:o,coord:r,draw:s,value:a}},function(t){t[t.Empty=0]="Empty",t[t.X=1]="X",t[t.O=2]="O"}(i||(e.State=i={})),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.DiagonalLTRB=2]="DiagonalLTRB",t[t.DiagonalLBRT=3]="DiagonalLBRT"}(n||(e.Line=n={}))}},e={};!function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}(156)})();
//# sourceMappingURL=game.js.map